### Exploit Prediction Automator
- json
- requests
- pandas
- datetime
------------

#### Mission 
- Build a tool that fetches data from the EPSS (Exploit Prediction Scoring System). This is a live, open-source project that gives a probability score (from 0 to 1) that a given vulnerability will be exploited in the next 30 days.
- Our tool will automate the process of finding the most critical, highly-probable threats that need immediate attention and generate a report for us to view these predictions
- We will define "critical" by filtering any vulnerability that has an epss score of 0.75% or above

#### Workflow
1. Import libraries
2. Define Global Variables
3. Make a GET request to the API and SCOUT the data FIRST. Don't forget to wrap request in try/except block for error handling
4. Once happy with the data and the json keys we need, extract the relevant key(s) and load the data into dataframe
5. Clean and convert data. In this case, we will need to convert the 'epss' column to an integer so we can use conditional filters later on
6. Format the columns until we're happy with the order in which the data is displayed
7. Get todays date
8. Define our filename
9. Define for-loop to only write a report if there is data. We don't want our script to generate empty reports!

#### Example Script

```Python
import requests
import json
import pandas as pd
from datetime import datetime

current_time = datetime.now()
api_url = "https://api.first.org/data/v1/epss?epss-gt=0.75" # Only show me vulns in 0.75 percentile

try:
    response = requests.get(api_url)
    if response.status_code == 200:
        print(f"Successful connection: {response.status_code}\n")

        data = response.json()
        data_key = data['data']
        df = pd.DataFrame(data_key)
        df['epss'] = pd.to_numeric(df['epss'])
        df = df[['date', 'cve', 'epss', 'percentile']]
        top_vulns_sorted = df.sort_values(by='epss', ascending=False)

        today_date = datetime.now().strftime("%Y-%m-%d")
        filename = f"epss_high_priority_report_{today_date}.csv"

        if not top_vulns_sorted.empty:
            top_vulns_sorted.to_csv(filename, index=False)
            print(f"\n[+] Report saved to {filename}")
        else:
            print("\n[+] No high-priority vulnerabilities found with EPSS > 0.75.") 

    else:
        print(f"Unable to connect to Endpoint: {response.status_code}")

except requests.exceptions.RequestException as error:
    print(f"Unable to connect to Endpoint: {error}")
```
